#!/bin/sh

# Fly.io clustering configuration
if [ -n "$FLY_APP_NAME" ]; then
  # Use IPv6 for Erlang distribution
  export ERL_AFLAGS="-proto_dist inet6_tcp"

  # Configure named distribution
  export RELEASE_DISTRIBUTION="name"
  export RELEASE_NODE="${FLY_APP_NAME}-${FLY_IMAGE_REF##*-}@${FLY_PRIVATE_IP}"
fi

# Enable IPv6 for Ecto if on Fly.io
if [ -n "$FLY_PRIVATE_IP" ]; then
  export ECTO_IPV6="true"
fi
